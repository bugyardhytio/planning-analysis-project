{
    "collab_server" : "",
    "contents" : "setwd(\"~/R/magangRCUS/penjaringan/data/demografi/per-usia\")\n\n# PRE-ANALYSIS ----\n## Import and Cleaning Data ----\ndata2013 <- read_csv(\"penduduk_2013.csv\")\ndata2014 <- read_csv(\"penduduk_2014.csv\")\ndata2015 <- read_csv(\"penduduk_2015.csv\")\ndata2016 <- read_csv(\"penduduk_2016.csv\")\ndata2017 <- read_csv(\"penduduk_2017.csv\")\n\n## Matching Column Name ----\nnama.kolom <- c(\"tahun\", \"provinsi\", \"kabupaten\", \"kecamatan\", \"kelurahan\", \"usia\", \"jenisKelamin\", \"jumlah\")\ndatalist <- list(data2013, data2014, data2015, data2016, data2017)\n\nfor (i in 1:length(datalist)) {\n  colnames(datalist[[i]]) <- nama.kolom\n}\n\n## Joining data ----\ndf <- bind_rows(datalist)\n\n## Cleaning Data ----\ndf <- na.omit(df)\ndf$provinsi <- str_replace(df$provinsi, \"PROVINSI DKI JAKARTA\", \"DKI Jakarta\")\ndf$usia <- str_replace(df$usia, \"9-May\", \"05-09\")\ndf$usia <- str_replace(df$usia, \"14-Oct\", \"10-14\")\ndf$usia <- str_replace(df$usia, \"70-75\", \"70-74\")\ndf$usia <- str_replace(df$usia, \">75\", \"75++\")\ndf$jenisKelamin <- str_replace(df$jenisKelamin, \"Laki laki\", \"Pria\")\ndf$jenisKelamin <- str_replace(df$jenisKelamin, \"Laki-laki\", \"Pria\")\ndf$jenisKelamin <- str_replace(df$jenisKelamin, \"Laki-Laki\", \"Pria\")\ndf$jenisKelamin <- str_replace(df$jenisKelamin, \"Perempuan\", \"Wanita\")\ndf$kabupaten <- str_replace(df$kabupaten, \" \", \".\")\ndf$kelurahan <- str_replace(df$kelurahan, \"P\\\\. \", \"PULAU \")\ndf$kelurahan <- str_replace(df$kelurahan, \"KUSUMAH\", \"KUSUMA\")\ndf$kelurahan <- str_replace(df$kelurahan, \"KERENDANG\", \"KRENDANG\")\ndf$kelurahan <- str_replace(df$kelurahan, \"BALI MESTER\", \"BALIMESTER\")\ndf$kelurahan <- str_replace(df$kelurahan, \"PAL MERIAM\", \"PALMERIAM\")\ndf$kelurahan <- str_replace(df$kelurahan, \"KAMPUNG TENGAH\", \"TENGAH\")\n\ndfKec <- df %>%\n  select(kelurahan, kecamatan) %>%\n  distinct(kelurahan, kecamatan)\ndfKab <- df %>%\n  select(kelurahan, kabupaten) %>%\n  distinct(kelurahan, kabupaten)\ndf2017 <- df %>%\n  filter(tahun == 2017)\n\n\n# EXPLORATORY DATA ANALYSIS ----\n## Setup Variabel ----\n### Filter kecamatan penjaringan aja\nkecPenjaringan <- df %>%\n  filter(kecamatan == \"PENJARINGAN\")\n\n### filter kelurahan penjaringan aja\nkelPenjaringan <- kecPenjaringan %>%\n  filter(kelurahan == \"PENJARINGAN\")\n\n\n## Jumlah penduduk ----\n### per tahun ----\naggPendUsia <- df %>% \n  group_by(tahun) %>%\n  summarize(jumlahPenduduk = sum(jumlah))\n\naggPendUsia %>%\n  ggplot(aes(tahun, jumlahPenduduk)) +\n  geom_line() +\n  ylim(0, 10400000)\n\n\n### per tahun per jenis kelamin ----\naggPendUsiaJK <- df %>%\n  group_by(tahun, jenisKelamin) %>%\n  summarize(jumlahPenduduk = sum(jumlah))\n\naggPendUsiaJK %>%\n  ggplot(aes(tahun, jumlahPenduduk, col = jenisKelamin)) +\n  geom_line() +\n  ylim(0, 5300000)\n\n### per tahun per kelurahan ----\ndf %>%\n  group_by(tahun, kelurahan) %>%\n  summarize(jumlahPenduduk = sum(jumlah)) %>%\n  ggplot(aes(tahun, jumlahPenduduk, fill = kabupaten)) +\n  geom_col(position = \"fill\")\n\ndf %>%\n  group_by(tahun, kabupaten) %>%\n  summarize(jumlahPenduduk = sum(jumlah)) %>%\n  ggplot(aes(kabupaten, jumlahPenduduk, fill = tahun)) +\n  geom_col(position = \"fill\")\n\ndf %>%\n  group_by(tahun, kabupaten) %>%\n  summarize(jumlahPenduduk = sum(jumlah)) %>%\n  spread(kabupaten, jumlahPenduduk)\n\n\n# Jumlah penduduk per kelurahan per tahun ----\npendudukKel <- df %>%\n  group_by(tahun, kelurahan, kecamatan, kabupaten) %>%\n  summarize(jumlahPenduduk = sum(jumlah)) \n\npendudukKel2017 <- pendudukKel %>%\n  filter(tahun == 2017) %>%\n  arrange(jumlahPenduduk)\n\n\n## Rasio ketergantungan ----\n### Bagaimana posisi dependency ratio kelurahan penjaringan dibanding kelurahan-kelurahan lain\ndepRatio <- df %>%\n  mutate(usiaProduktif = ifelse(usia %in% c(\"0-4\", \"5-9\", \"10-14\", \"65-69\", \"70-74\", \">75\"), \"Tidak\", \"Ya\")) %>%\n  group_by(usiaProduktif, tahun) %>%\n  summarize(n = sum(jumlah)) %>%\n  ungroup() %>%\n  spread(usiaProduktif, n) %>%\n  mutate(dependencyRat = Tidak / Ya * 100) %>%\n  select(tahun, dependencyRat)\n\ndepRatioKelurahan <- df %>%\n  mutate(usiaProduktif = ifelse(usia %in% c(\"0-4\", \"5-9\", \"10-14\", \"65-69\", \"70-74\", \">75\"), \"Tidak\", \"Ya\")) %>%\n  group_by(usiaProduktif, kelurahan) %>%\n  summarize(n = sum(jumlah)) %>%\n  ungroup() %>%\n  spread(usiaProduktif, n) %>%\n  mutate(dependencyRat = Tidak / Ya * 100) %>%\n  select(kelurahan, dependencyRat) %>%\n  arrange(dependencyRat)\n\n### histogram\nhist(depRatioKelurahan$dependencyRat)\n\n\n### peta ----\nshpDepRatio <- inner_join(kelurahan, depRatioKelurahan, by = \"kelurahan\")\nshpDepRatio <- inner_join(shpDepRatio, dfKec, by = \"kelurahan\")\nshpDepRatio <- inner_join(shpDepRatio, dfKab, by = \"kelurahan\")\nshpDepRatio <- select(shpDepRatio, kelurahan, kecamatan, kabupaten, dependencyRat, geometry)\n\nshpDepRatio %>%\n  filter(grepl(\"JAKARTA\", kabupaten)) %>%\n  tm_shape() +\n  tm_fill(col = \"dependencyRat\")\n\n\n## Piramida Penduduk ----\ndfPyramid <- df %>%\n  filter(jenisKelamin == \"Pria\") %>%\n  mutate(jumlah = -jumlah) %>%\n  rbind(subset(df, jenisKelamin == \"Wanita\"))\n\nggplot(dfPyramid, aes(x = usia, y = jumlah, fill = jenisKelamin)) + \n  geom_bar(stat = \"identity\") + \n  coord_flip() + \n  scale_fill_brewer(palette = \"Set1\") + \n  theme_bw()\n\n## Sex Ratio ----\ndf %>%\n  spread(jenisKelamin, jumlah) %>%\n  group_by(tahun) %>%\n  summarize(aggPria = as.numeric(sum(Pria)), aggWanita = as.numeric(sum(Wanita))) %>%\n  ungroup() %>%\n  mutate(sexRatio = aggPria / aggWanita)\n\n\n# Jumlah penduduk per kelurahan per tahun\nshpPendKel <- inner_join(kelurahan, pendudukKel, by = \"kelurahan\")\nshpPendKel <- select(shpPendKel, tahun, kelurahan, kecamatan, kabupaten, jumlahPenduduk, geometry)\n\nshpPendKel %>%\n  filter(grepl(\"JAKARTA\", kabupaten)) %>%\n  tm_shape() +\n  tm_fill(col = \"jumlahPenduduk\") +\n  tm_facets(\"tahun\")\n\npurple <- list(color = brewer.pal(3, \"Purples\"))",
    "created" : 1551075686281.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2995275460",
    "id" : "778ACBCA",
    "lastKnownWriteTime" : 1551425052,
    "last_content_update" : 1551425052144,
    "path" : "~/R/magangRCUS/penjaringan/data/demografi/analisis-demografi-usia.R",
    "project_path" : "data/demografi/analisis-demografi-usia.R",
    "properties" : {
        "docOutlineVisible" : "0"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}